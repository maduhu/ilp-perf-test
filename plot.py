#!/bin/python

import json
import matplotlib.pyplot as plt
import numpy as np

# result from the performance test
jsonString = '{"measureInterval":5,"completedPaymentsPerInterval":[53.4,52.6,52.4,52.6,52.4,52.6,51.8,52.2,51.4,52,52,52.2,52.4,51.6,52.6,51.6,52.6,52,51.2,52.8,52,52,23,4.4,41.4,52.2,67.8,49.2,56.2,53.2,65.4,61.8,55.2,56.8,56.4,67,49.2,49.4,48.6,56.8,60.8,50.6,53.6,47,43.8,51.8,33.4,8.2,27.6,61,57.6,59.2,57.8,52,60.2,62.4,58.2,60,51.8,57,51.8,48.6,50.2,53.6,58.8,50.4,46.2,56.4,42,54,45.6,9,25,49,66.8,58.6,63.4,51.8,65,64,54.2,54.4,52.4,48.6,55.4,53.8,47.4,52,50.4,58.4,44,50.2,49.2,44.6,49.4,23.4,19.2,49.2,70.6,65.8,60.2,49.8,64,63.2,50.2,58.6,52.6,47.6,56.4,54,47.8,52.4,52,50.8,42.8,52,53,44.8,52.6,26.4,22.8,36.8,81,63.2,58.8,55.2,61.6,58.4,51.8,51.4,54.4,47.4,50.2,55.8,50,49,53,52.4,43,46.4,59,45.8,50,30.2,24,37.2,75.2,76.4,47.8,61.4,57.6,61.6,51.8,47.8,51.4,45,50.8,60.6,44.2,47.8,52,51.8,47.6,46,56.2,52.8,51.4,39.8,27.2,39.6,62.6,75.6,50,60.2,56.6,60.8,53.4,52.8,49.4,44.8,47.4,53.2,49.6,52,49.6,49,48,51.8,55.8,45.8,55,42.8,32.4,42.8,63,74.4,49.6,57.2,56.8,49,55.8,52.6,48.8,47.4,48.6,57.6,44,56.2,58.4,44,54.8,46.4,55.4,53.6,46.4,39.8,34.4,41.2,52.2,73.6,56.2,55.6,58,43,51.8,46.2,49,54.4,47.6,62.8,39.8,50.6,57.8,46.6,60.6,42.4,57.8,45.2,49.6,47.4,42.6,35.4,51.4,75.2,67.2,50.6,57.6,41.2,51.8,44.6,45.6,49,47,61.8,56.2,51,51.4,49.2,63,45,62.6,40.4,51.8,46.2,37,38.6,50.2,65.6,69.8,51.2,60.4,34.6,56.4,44.4,43.4,56,44.6,59.6,56,52,47,50,58.4,55.4,57.6,36.6,54.6,44.2,42.4,47.2,45.8,70.2,65.2,55,50.2,42.8,59.4,47.8,38.4,53,50.4,57.4,55.8,43.8,46.6,52,52.2,60.8,48.2,35.2,58.8,47.6,42,49.4,48.2,68,60.4,49,40.8,48,62.8,47.4,45.8,52.8,53.6,57.6,58.4,48,40.2,52,49.6,54,52.8,44,50.2,52.6,46.4,42.6,51.6,67.8,54.8,52,37.8,52.2,53.2,52.6,48.6,50,56.8,49.4,67.6,40.6,41.8,49.4,51.2,57.4,51.8,44.4,52,52.4,48.6,44,51.8,67.4,47.4,53.6,46,56.2,49.2,65,44.4,50.6,55,47.4,57.4,45.6,44.4,50.4,45,65.2,44.2,48.8,46.2,58,48.8,42.8,57.4,54.8,62,42.8,55.6,50.4,41.8,63.6,46.2,49.2,49.2,52.6,52.8,53,45.4,50.2,44,61.6,54.8,54.8,44,61.6,43.4,46,59.8,57.4,58.6,44,55.2,48.6,50.6,53.2,52.2,46,42.8,55.2,53.4,53.2,38.4,52,48.2,55.2,63.6,58.6,44.6,58,43.8,51.2,60.2,50.6,56,43.6,50.8,45.2,56.4,52.2,53.8,44.8,48.6,51.8,55,53.6,45,46.4,46.4,59.8,66.4,54.4,38,53,53.8,48.4,50.4,49.8,50.6,40.4,55.6,50.6,56.2,49.2,53.2,50,49.8,62,53.6,55.6,47,43.4,52.4,55.2,61.6,51.8,51,50.6,52.2,50.6,48.6,45.4,49.8,41.8,51.4,48,68,44.2,55.8,55.8,49.6,54,52.6,46.8,44.6,47.8,52,51,59,51.2,55.8,47.6,58.4,47.2,50.8,51.8,53,42.2,48.6,50.6,64.2,44.2,51.4,61.6,49.6,48.2,56.8,39.8,43.4,45.8,51.2,51,59,55.8,49,51.6,54.6,47.6,49.8,48.2,54.4,44.8,56.4,53.2,56.4,50.8,49.8,56.2,47.4,49.4,59.8,36.4,40.2,47.4,49.6,53,61.2,56.8,53.6,53,56,45.4,49,44.2,48,50.6,49.6,55.2,56.6,56.8,46.2,51,48.8,50,56.2,40.8,44,48.6,51.6,54.2,62.6,57.6,48.4,52,49.8,45.6,51.4,57.2,41.6,56.4,43.4,57.4,52.8,57.4,51.8,44.8,51.6,51.8,50.2,44.8,42.4,47.6,57,48,58,59,45.4,61.6,43.8,48.2,54.4,53.4,38.4,51.2,47.2,59.6,47.6,63,47.4,49,51.2,50.8,55,46,41.2,44.2,51.2,53.4,59,50,49.4,52.2,50.2,49.2,48.6,60.8,40,49.2,54.2,56.8,45,70.4,39.4,46.4,43.2,56.6,55.6,44.2,52.4,46.4,52.4,56.2,55.4,47.6,50.8,52.8,53.2,43.8,47.8,55.8,53.4,43.8,49,54.6,42,67.8,40.2,51.4,41.8,59.4,55.2,50.2,49.2,43.4,60.2,57.4,50.2,49.8,44.6,59.2,51.4,40.8,48.6,51,56.8,46.6,49.8,49.6,42.6,57,45.4,52.8,49,64,43.8,48.2,55.4,47.4,57.4,50.8,57.8,52.8,45.8,55.2,49.4,47.2,44.2,48.4,57.2,47.4,46.6,53.2,43.6,51,45,60.8,46,61,49,51.4,50.4,50.2,53.4,47.4,52.6,51.2,47.6,55.2,51.4,43.2,44.6,51,62.4,45.6,43.2,49.6,52,42,55.2,61.4,42.2,58,54.6,54,54,45.6,47.6,49,50.2,56.8,47,57.2,53.2,42.4,45,49.4,64.4,44,46.8,50.6,51.6,43.8,44.6,48.4,55.6,49.8,58.4,53.4,55.8,45,48.2,52.4,54.4,55.4,47,52.8,61,41,47.8,53.2,68.6,43,52,45.2,44.8,42.6,43,47.2,59,48.6,60.6,52,55.4,45.6,53.4,46,56,52.4,49.6,56.8,53.6,41,47.2,54.2,58,50,46.8,47.2,46.6,41.6,46.4,51.4,55.6,50.4,58.2,58.2,57,41.4,47.2,53.2,51,58.6,44,53,58.8,41.2,39.8,51.6,56.2,57.4,46.6,48,50.2,43,45,47.8,64.4,38.2,62,60,53.8,52.4,44.4,58.6,46.2,59.2,44]}'

data = json.loads(jsonString)

result = data['completedPaymentsPerInterval']
measureInterval = data['measureInterval'] # in seconds

numDataPoints = 60 * 60 / measureInterval
print numDataPoints, measureInterval, len(result), len(result)-numDataPoints

if (len(result) > numDataPoints):
	# we only want one hour worth of measurments
	result = result[:numDataPoints]

# calculate average per minute
dataPointsPerMinute = 60 / measureInterval
tmp = np.array(result).reshape(-1, dataPointsPerMinute)
avg = np.mean(tmp, axis=1)

plt.plot(avg)
plt.plot([0, 60],[50,50])
plt.xlabel('Minutes')
plt.ylabel('Successful Payments')
axes = plt.gca()
axes.set_ylim([0,60])
plt.show()
